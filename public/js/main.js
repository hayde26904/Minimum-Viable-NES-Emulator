(()=>{"use strict";var t,e,r=function(t,e){this.method=t,this.numArgs=e},o=new Map([[169,new r((function(t,e,r){var o=r[0];t.setAreg(o)}),1)],[76,new r((function(t,e,r){var o=n.bytesToAddr(r[0],r[1]);t.setPC(o-r.length-1)}),2)]]),n=function(){function t(){this.prgRom,this.Areg=0,this.Xreg=0,this.Yreg=0,this.PC=32768,this.SP=0,this.Cflag=!1,this.Zflag=!1,this.Nflag=!1}return t.bytesToAddr=function(t,e){return e<<8|t},t.prototype.loadProgram=function(t){this.prgRom=t,console.log("Program loaded: ",this.prgRom)},t.prototype.executeOperation=function(){var t=this.prgRom,e=this.PC-32768,r=t.read(e);if(console.log("PC: ",this.PC),o.has(r)){for(var n=o.get(r),i=new Uint8Array(n.numArgs),s=0;s<n.numArgs;s++)i[s]=t.read(e+s+1);n.method(this,t,i),this.PC+=n.numArgs+1}else console.log("Invalid or unimplemented opcode: ".concat(r)),this.PC++},t.prototype.setPC=function(t){this.PC=t,console.log("SET PC: ",this.PC)},t.prototype.getPC=function(){return this.PC},t.prototype.setAreg=function(t){this.Areg=255&t,this.setFlags(t),console.log("SET AREG: ",this.Areg)},t.prototype.setXreg=function(t){this.Xreg=255&t,this.setFlags(t)},t.prototype.setYreg=function(t){this.Yreg=255&t,this.setFlags(t)},t.prototype.getAreg=function(){return this.Areg},t.prototype.getXreg=function(){return this.Xreg},t.prototype.getYreg=function(){return this.Yreg},t.prototype.setFlags=function(t){if(-1!==t){var e=t;this.Cflag=this.overflow,this.Zflag=0===e,this.Nflag=!(128&~e)}},t.prototype.getFlags=function(){return{Z:this.Zflag,N:this.Nflag,C:this.Cflag}},t}(),i=function(){function t(t){this.memory=new Uint8Array(2048),null!==t&&(this.memory=t)}return t.prototype.read=function(t){return this.memory[t]},t.prototype.write=function(t,e){this.memory[t]=e},t}(),s=(t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)},function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}),u=function(t){function e(e){return t.call(this,e)||this}return s(e,t),e}(i),a=new Uint8Array(5).fill(0);a[0]=169,a[1]=105,a[2]=76,a[3]=0,a[4]=128,new u(a);var l=new n;function g(){l.executeOperation()}null===(e=document.getElementById("romInput"))||void 0===e||e.addEventListener("change",(function(t){var e=t.target;if(e.files&&e.files[0]){var r=e.files[0],o=new FileReader;o.onload=function(t){var e;if(null===(e=t.target)||void 0===e?void 0:e.result){var r=new Uint8Array(t.target.result);l.loadProgram(new u(r)),setInterval(g,500)}},o.readAsArrayBuffer(r)}}))})();