(()=>{"use strict";var t,e=function(){function t(){}return t.bytesToAddr=function(t,e){return e<<8|t},t.hex=function(t){return t.toString(16).toUpperCase()},t}();function r(t,r,o){t.setAreg(o),console.log("Loaded ".concat(e.hex(t.getAreg())," into A"))}function o(t,r,o){r.write(t.getAreg(),o),console.log("Stored ".concat(e.hex(t.getAreg())," into memory at ").concat(e.hex(o)))}function n(t,r,o){t.setPC(o),console.log("Jumped to ".concat(e.hex(o)))}!function(t){t[t.value=0]="value",t[t.pointer=1]="pointer"}(t||(t={}));var i,c=new Map([[169,{method:r,addrMode:1,argType:t.value,cycles:2}],[165,{method:r,addrMode:2,argType:t.pointer,cycles:3}],[181,{method:r,addrMode:3,argType:t.pointer,cycles:4}],[173,{method:r,addrMode:5,argType:t.pointer,cycles:4}],[189,{method:r,addrMode:6,argType:t.pointer,cycles:4}],[185,{method:r,addrMode:7,argType:t.pointer,cycles:4}],[161,{method:r,addrMode:11,argType:t.pointer,cycles:6}],[177,{method:r,addrMode:12,argType:t.pointer,cycles:5}],[133,{method:o,addrMode:2,argType:t.value,cycles:3}],[149,{method:o,addrMode:3,argType:t.value,cycles:4}],[141,{method:o,addrMode:5,argType:t.value,cycles:4}],[157,{method:o,addrMode:6,argType:t.value,cycles:5}],[153,{method:o,addrMode:7,argType:t.value,cycles:5}],[129,{method:o,addrMode:11,argType:t.value,cycles:6}],[145,{method:o,addrMode:12,argType:t.value,cycles:6}],[76,{method:n,addrMode:5,argType:t.value,cycles:3}],[108,{method:n,addrMode:10,argType:t.value,cycles:5}]]),s=new Map([[0,1],[1,1],[2,2],[3,2],[4,2],[5,3],[6,3],[7,3],[8,1],[9,2],[10,3],[11,3],[12,3]]),a=new Map([[0,function(t,e,r,o){return null}],[1,function(t,e,r,o){return r[0]}],[2,function(t,e,r,o){return r[0]}],[3,function(t,e,r,o){return r[0]+e.getXreg()}],[4,function(t,e,r,o){return r[0]+e.getYreg()}],[5,function(t,r,o,n){return e.bytesToAddr(o[0],o[1])}],[6,function(t,r,o,n){return e.bytesToAddr(o[0],o[1])}],[7,function(t,r,o,n){return e.bytesToAddr(o[0],o[1])}],[8,function(t,e,r,o){return e.getAreg()}],[9,function(t,e,r,o){var n=128&~r[0]?r[0]:r[0]-256;return e.getPC()+n}],[10,function(t,r,o,n){return t.read(e.bytesToAddr(o[0],o[1]))}],[11,function(t,r,o,n){return t.read(e.bytesToAddr(o[0],o[1])+r.getXreg())}],[12,function(t,r,o,n){return e.bytesToAddr(o[0],o[1])+r.getYreg()}]]),u=function(){function e(){this.Areg=0,this.Xreg=0,this.Yreg=0,this.PC=32768,this.SP=0,this.Cflag=!1,this.Zflag=!1,this.Nflag=!1}return e.prototype.reset=function(){this.Areg=0,this.Xreg=0,this.Yreg=0,this.PC=32768,this.SP=0,this.Cflag=!1,this.Zflag=!1,this.Nflag=!1},e.prototype.executeOperation=function(e,r){var o=r,n=this.PC-32768,i=o.read(n);if(c.has(i)){for(var u=c.get(i),d=(u.method,u.addrMode),p=u.argType,l=s.get(d),g=new Uint8Array(l),h=0;h<l;h++)g[h]=o.read(n+h);var f=a.get(d)(e,this,g,p);switch(p){case t.value:break;case t.pointer:f=e.read(f)}console.log("executing opcode: ".concat(i.toString(16)," with arg: ").concat(f.toString(16))),u.method(this,e,f),this.PC+=l}else console.log("Invalid or unimplemented opcode: ".concat(i)),this.PC++},e.prototype.setPC=function(t){this.PC=t,console.log("SET PC: ",this.PC)},e.prototype.getPC=function(){return this.PC},e.prototype.setAreg=function(t){this.Areg=255&t,this.setFlags(t),console.log("SET AREG: ",this.Areg)},e.prototype.setXreg=function(t){this.Xreg=255&t,this.setFlags(t)},e.prototype.setYreg=function(t){this.Yreg=255&t,this.setFlags(t)},e.prototype.getAreg=function(){return this.Areg},e.prototype.getXreg=function(){return this.Xreg},e.prototype.getYreg=function(){return this.Yreg},e.prototype.setFlags=function(t){if(-1!==t){var e=t;this.Cflag=this.overflow,this.Zflag=0===e,this.Nflag=!(128&~e)}},e.prototype.getFlags=function(){return{Z:this.Zflag,N:this.Nflag,C:this.Cflag}},e}(),d=function(){function t(t,e){this.memory=e||new Uint8Array(t).fill(0)}return t.prototype.read=function(t){return this.memory[t]},t.prototype.write=function(t,e){this.memory[e]=t},t}(),p=(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),l=function(t){function e(e,r){return t.call(this,e,r)||this}return p(e,t),e}(d),g=function(){function t(){this.cpu=new u,this.ram=new l(2048),this.currentPrgRom=null}return t.prototype.loadProgram=function(t){this.cpu.reset(),this.currentPrgRom=t},t.prototype.step=function(){this.cpu.executeOperation(this.ram,this.currentPrgRom)},t}(),h=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),f=function(t){function e(e){return t.call(this,e.length,e)||this}return h(e,t),e}(d),y=new Uint8Array(13).fill(0);y[0]=169,y[1]=105,y[2]=133,y[3]=1,y[4]=165,y[5]=1,y[6]=133,y[7]=2,y[8]=76,y[9]=0,y[10]=128;var m=new f(y),v=new g;v.loadProgram(m),setInterval((function(){v.step()}),500)})();